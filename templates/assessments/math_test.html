{% extends "base.html" %}
{% block title %}Math Test{% endblock %}
{% block content %}
<div class="row justify-content-center">
	<div class="col-md-7">
		<div class="card">
			<div class="card-body">
				<h2 class="mb-4">Math Test</h2>
				<div class="timer-display text-center">
					⏱️ Time Remaining: <span id="time">180</span> seconds
				</div>
				<p class="text-muted mb-4">Answer all questions. The test will auto-submit when time runs out.</p>
				<form id="math-form" method="post" action="{% url 'math_test_submit' %}">
					{% csrf_token %}
					{% for q in questions %}
					<div class="test-question">
						<div class="test-question-number">Question {{ forloop.counter }} of {{ questions|length }}</div>
						<div class="test-input-group">
							<span class="fs-5">{{ q.a }} {{ q.op }} {{ q.b }} =</span>
							<input type="number" name="q_{{ forloop.counter0 }}" required class="form-control" style="max-width: 150px;">
						</div>
					</div>
					{% endfor %}
					<div class="text-center mt-4">
						<button class="btn btn-primary btn-lg px-5" type="submit">Submit Answers</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<script>
(function(){
	let seconds = 180;
	const el = document.getElementById('time');
	const form = document.getElementById('math-form');
	const timer = setInterval(()=>{
		seconds -= 1;
		el.textContent = seconds;
		if(seconds <= 0){
			clearInterval(timer);
			form.submit();
		}
	}, 1000);
})();
</script>
{% endblock %}
